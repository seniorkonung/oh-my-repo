[tools]
python = "3.11"

[tasks.prepare-tts]
hide = true
run = '''
#!/usr/bin/env bash
sudo apt install ffmpeg
pip install piper-tts
python -m piper.download_voices ru_RU-ruslan-medium --data-dir $(pwd)/data
'''

[tasks.start-tts]
run = '''
#!/usr/bin/env bash
if [ ! -f $OH_MY_REPO/data/ru_RU-ruslan-medium.onnx ]; then
    mise run prepare-tts
fi
cat $OH_MY_REPO/data/input.txt | piper -m $OH_MY_REPO/data/ru_RU-ruslan-medium -f $OH_MY_REPO/data/output.wav --sentence-silence 0.6
ffmpeg -y -i $OH_MY_REPO/data/output.wav -codec:a libmp3lame -qscale:a 2 $OH_MY_REPO/data/output.mp3
telegram-desktop -sendpath $OH_MY_REPO/data/output.mp3
'''
